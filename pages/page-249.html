<section class="page-section" id="page-249">
    <div class="page-header">
        <div class="page-number">249</div>
        <div class="page-title">
            <h3>7.1.2 Regularizare L¬π</h3>
            <span>L¬π Parameter Regularization</span>
        </div>
    </div>
    <div class="image-container">
        <img src="../book_page_jpg/Ian Goodfellow, Yoshua Bengio, Aaron Courville - Deep Learning (2017, MIT)-page-249.jpg"
             alt="Pagina 249" class="page-image" onclick="zoomImage(this)">
    </div>
    <div class="explanation-content">

        <div class="interactive-paragraph">
            <div class="paragraph-main" onclick="toggleParagraph(this)">
                <h4>Solutia Ridge Regression in Forma Inchisa</h4>
                <p>Pentru regresie liniara cu cost MSE, solutia fara regularizare este w = (X‚ä§X)‚Åª¬πX‚ä§y. Cu regularizare L¬≤, solutia devine:</p>
                <div class="formula" style="margin: 15px 0; padding: 15px; background: var(--bg-dark); border-radius: 8px; text-align: center;">
                    w = (X‚ä§X + Œ±I)‚Åª¬πX‚ä§y
                </div>
                <p>Matricea X‚ä§X este proportionala cu matricea de covarianta. L¬≤ face algoritmul sa "perceapa" inputul ca avand varianta mai mare, ceea ce face sa micsoreze weights-urile pentru features cu covarianta mica cu output-ul.</p>
            </div>
            <div class="expandable-sections">
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon simulation">üéÆ</div>
                        <span>Cod: Ridge vs OLS</span>
                        <span class="arrow">‚ñ∂</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div class="code-block">
import numpy as np

# OLS (Ordinary Least Squares)
w_ols = np.linalg.solve(X.T @ X, X.T @ y)

# Ridge Regression
alpha = 0.1
I = np.eye(X.shape[1])
w_ridge = np.linalg.solve(X.T @ X + alpha * I, X.T @ y)

# Ridge cu sklearn
from sklearn.linear_model import Ridge
ridge = Ridge(alpha=0.1).fit(X, y)
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="interactive-paragraph">
            <div class="paragraph-main" onclick="toggleParagraph(this)">
                <h4>Regularizarea L¬π - Norma Absoluta</h4>
                <p>In timp ce L¬≤ (weight decay) este cea mai comuna forma, o alternativa este regularizarea L¬π. Penalizarea este definita ca suma valorilor absolute ale parametrilor:</p>
                <div class="formula" style="margin: 15px 0; padding: 15px; background: var(--bg-dark); border-radius: 8px; text-align: center;">
                    Œ©(Œ∏) = ||w||‚ÇÅ = Œ£·µ¢ |w·µ¢|
                </div>
                <p>Functia obiectiv regularizata devine:</p>
                <div class="formula" style="margin: 15px 0; padding: 15px; background: var(--bg-dark); border-radius: 8px; text-align: center;">
                    JÃÉ(w; X, y) = Œ±||w||‚ÇÅ + J(w; X, y)
                </div>
            </div>
            <div class="expandable-sections">
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon animation">‚ú®</div>
                        <span>L¬π vs L¬≤ - Diferenta Fundamentala</span>
                        <span class="arrow">‚ñ∂</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <div style="background: linear-gradient(90deg, rgba(37, 99, 235, 0.25) 0%, var(--bg-lighter) 20%); padding: 15px; border-radius: 8px; box-shadow: 0 0 15px rgba(37, 99, 235, 0.1);">
                                    <strong style="color: var(--primary);">L¬≤ Regularization</strong>
                                    <div class="formula" style="margin: 10px 0;">Œ© = Œ£ w·µ¢¬≤</div>
                                    <p style="font-size: 0.9rem;">Gradient: 2w·µ¢</p>
                                    <p style="font-size: 0.85rem; color: var(--text-secondary);">Scaleaza liniar cu w</p>
                                </div>
                                <div style="background: linear-gradient(90deg, rgba(6, 182, 212, 0.25) 0%, var(--bg-lighter) 20%); padding: 15px; border-radius: 8px; box-shadow: 0 0 15px rgba(6, 182, 212, 0.1);">
                                    <strong style="color: var(--accent);">L¬π Regularization</strong>
                                    <div class="formula" style="margin: 10px 0;">Œ© = Œ£ |w·µ¢|</div>
                                    <p style="font-size: 0.9rem;">Gradient: sign(w·µ¢)</p>
                                    <p style="font-size: 0.85rem; color: var(--text-secondary);">Constant! Nu depinde de w</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon simulation">üéÆ</div>
                        <span>Cod: L¬π in PyTorch</span>
                        <span class="arrow">‚ñ∂</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div class="code-block">
import torch

# L1 regularization manual
l1_lambda = 0.001
l1_penalty = sum(p.abs().sum() for p in model.parameters())

loss = criterion(model(X), y) + l1_lambda * l1_penalty
loss.backward()

# Gradient-ul este sign(w), nu 2*w ca la L2
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</section>
