        <section class="page-section" id="page-92">
            <div class="page-header">
                <div class="page-number">92</div>
                <div class="page-title">
                    <h3>3.14 Modele Probabilistice Structurate</h3>
                    <span>Graphical Models - Directed si Undirected</span>
                </div>
            </div>
            <div class="image-container">
                <img src="../book_page_jpg/Ian Goodfellow, Yoshua Bengio, Aaron Courville - Deep Learning (2017, MIT)-page-092.jpg"
                     alt="Pagina 92" class="page-image" onclick="zoomImage(this)">
            </div>
            <div class="explanation-content">

                <div class="interactive-paragraph">
                    <div class="paragraph-main" onclick="toggleParagraph(this)">
                        <h4>Factorizarea Distributiilor</h4>
                        <p>In loc de o singura functie pentru toata distributia comuna, o <strong>factorizam</strong> in produs de factori mai simpli. De exemplu, daca a influenteaza b, si b influenteaza c, dar a si c sunt independent conditionate de b: p(a, b, c) = p(a) √ó p(b|a) √ó p(c|b). Aceasta reduce drastic numarul de parametri!</p>
                    </div>
                    <div class="expandable-sections">
                        <div class="section-tab">
                            <div class="section-header" onclick="toggleSection(this)">
                                <div class="section-icon animation">‚ú®</div>
                                <span>Vizualizare: Factorizare</span>
                                <span class="arrow">‚ñ∂</span>
                            </div>
                            <div class="section-content">
                                <div class="section-body">
                                    <div class="formula" style="text-align: center; margin-bottom: 15px; padding: 15px; background: var(--bg-lighter); border-radius: 8px;">
                                        p(a, b, c) = p(a) √ó p(b | a) √ó p(c | b)
                                    </div>
                                    <div style="display: flex; justify-content: center; align-items: center; gap: 20px;">
                                        <div style="width: 50px; height: 50px; border-radius: 50%; background: var(--accent); display: flex; align-items: center; justify-content: center; font-weight: bold;">a</div>
                                        <div style="font-size: 1.5rem;">‚Üí</div>
                                        <div style="width: 50px; height: 50px; border-radius: 50%; background: var(--secondary); display: flex; align-items: center; justify-content: center; font-weight: bold;">b</div>
                                        <div style="font-size: 1.5rem;">‚Üí</div>
                                        <div style="width: 50px; height: 50px; border-radius: 50%; background: var(--warning); display: flex; align-items: center; justify-content: center; font-weight: bold;">c</div>
                                    </div>
                                    <p style="margin-top: 15px; text-align: center; font-size: 0.85rem; color: var(--text-secondary);">
                                        a ‚Üí b ‚Üí c : "a si c sunt d-separated de b"
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="interactive-paragraph">
                    <div class="paragraph-main" onclick="toggleParagraph(this)">
                        <h4>Modele Grafice (Graphical Models)</h4>
                        <p>Factorizarile pot fi descrise folosind <strong>grafuri</strong>. Fiecare nod = o variabila aleatoare. Muchiile arata care variabile interactioneaza direct. Aceasta reprezentare se numeste <strong>model probabilistic structurat</strong> sau <strong>model grafic</strong>. Exista doua tipuri principale: <strong>directed</strong> (Bayesian Networks) si <strong>undirected</strong> (Markov Random Fields).</p>
                    </div>
                    <div class="expandable-sections">
                        <div class="section-tab">
                            <div class="section-header" onclick="toggleSection(this)">
                                <div class="section-icon animation">‚ú®</div>
                                <span>Vizualizare: Directed vs Undirected</span>
                                <span class="arrow">‚ñ∂</span>
                            </div>
                            <div class="section-content">
                                <div class="section-body">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                        <div style="background: var(--bg-lighter); padding: 15px; border-radius: 8px; text-align: center;">
                                            <strong style="color: var(--accent);">Directed (Bayesian Network)</strong>
                                            <div style="margin: 15px 0;">
                                                <svg width="120" height="80" viewBox="0 0 120 80">
                                                    <circle cx="60" cy="15" r="12" fill="var(--accent)"/>
                                                    <circle cx="30" cy="65" r="12" fill="var(--secondary)"/>
                                                    <circle cx="90" cy="65" r="12" fill="var(--warning)"/>
                                                    <line x1="50" y1="25" x2="35" y2="50" stroke="white" stroke-width="2" marker-end="url(#arrow)"/>
                                                    <line x1="70" y1="25" x2="85" y2="50" stroke="white" stroke-width="2" marker-end="url(#arrow)"/>
                                                    <text x="60" y="18" fill="white" font-size="10" text-anchor="middle">a</text>
                                                    <text x="30" y="68" fill="white" font-size="10" text-anchor="middle">b</text>
                                                    <text x="90" y="68" fill="white" font-size="10" text-anchor="middle">c</text>
                                                </svg>
                                            </div>
                                            <p style="font-size: 0.8rem; color: var(--text-secondary);">p(x) = ‚àè·µ¢ p(x·µ¢ | Parents(x·µ¢))</p>
                                        </div>
                                        <div style="background: var(--bg-lighter); padding: 15px; border-radius: 8px; text-align: center;">
                                            <strong style="color: var(--secondary);">Undirected (MRF)</strong>
                                            <div style="margin: 15px 0;">
                                                <svg width="120" height="80" viewBox="0 0 120 80">
                                                    <circle cx="60" cy="15" r="12" fill="var(--accent)"/>
                                                    <circle cx="30" cy="65" r="12" fill="var(--secondary)"/>
                                                    <circle cx="90" cy="65" r="12" fill="var(--warning)"/>
                                                    <line x1="50" y1="25" x2="35" y2="50" stroke="white" stroke-width="2"/>
                                                    <line x1="70" y1="25" x2="85" y2="50" stroke="white" stroke-width="2"/>
                                                    <line x1="42" y1="65" x2="78" y2="65" stroke="white" stroke-width="2"/>
                                                    <text x="60" y="18" fill="white" font-size="10" text-anchor="middle">a</text>
                                                    <text x="30" y="68" fill="white" font-size="10" text-anchor="middle">b</text>
                                                    <text x="90" y="68" fill="white" font-size="10" text-anchor="middle">c</text>
                                                </svg>
                                            </div>
                                            <p style="font-size: 0.8rem; color: var(--text-secondary);">p(x) = (1/Z) ‚àè_C œà_C(x_C)</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="interactive-paragraph">
                    <div class="paragraph-main" onclick="toggleParagraph(this)">
                        <h4>Modele Directed (Bayesian Networks)</h4>
                        <p>Modelele <strong>directed</strong> folosesc grafuri cu <strong>muchii orientate</strong>. Factorizarea este data de probabilitati conditionate: p(<strong>x</strong>) = ‚àè·µ¢ p(x·µ¢ | Pa_G(x·µ¢)), unde Pa_G(x·µ¢) sunt "parintii" lui x·µ¢ in graf (nodurile cu muchii spre x·µ¢). Fiecare factor este o distributie conditionata legitima!</p>
                    </div>
                    <div class="expandable-sections">
                        <div class="section-tab">
                            <div class="section-header" onclick="toggleSection(this)">
                                <div class="section-icon simulation">üéÆ</div>
                                <span>Cod: Bayesian Network simplu</span>
                                <span class="arrow">‚ñ∂</span>
                            </div>
                            <div class="section-content">
                                <div class="section-body">
                                    <div class="code-block">
import numpy as np

# Exemplu: Boala -> Simptom, Boala -> Test
# Graf: B -> S, B -> T

# P(B) - prior boala
p_b = 0.01

# P(S | B) - simptom dat boala
p_s_given_b = 0.9    # P(S=1 | B=1)
p_s_given_not_b = 0.1  # P(S=1 | B=0)

# P(T | B) - test dat boala
p_t_given_b = 0.95   # P(T=1 | B=1)
p_t_given_not_b = 0.05  # P(T=1 | B=0)

# Distributia comuna prin factorizare:
# P(B, S, T) = P(B) * P(S|B) * P(T|B)

def joint_prob(b, s, t):
    """P(B=b, S=s, T=t)"""
    p = p_b if b else (1 - p_b)
    p *= (p_s_given_b if b else p_s_given_not_b) if s else \
         (1 - p_s_given_b if b else 1 - p_s_given_not_b)
    p *= (p_t_given_b if b else p_t_given_not_b) if t else \
         (1 - p_t_given_b if b else 1 - p_t_given_not_b)
    return p

# Verificare normalizare
total = sum(joint_prob(b, s, t)
            for b in [0, 1] for s in [0, 1] for t in [0, 1])
print(f"Suma totala: {total:.6f}")  # = 1.0

# P(B=1 | S=1, T=1) prin Bayes
p_bst = joint_prob(1, 1, 1)
p_st = joint_prob(0, 1, 1) + joint_prob(1, 1, 1)
p_b_given_st = p_bst / p_st
print(f"P(boala | simptom+, test+) = {p_b_given_st:.3f}")
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="section-tab">
                            <div class="section-header" onclick="toggleSection(this)">
                                <div class="section-icon reference">üìö</div>
                                <span>Exemple in ML</span>
                                <span class="arrow">‚ñ∂</span>
                            </div>
                            <div class="section-content">
                                <div class="section-body">
                                    <ul class="reference-list">
                                        <li class="reference-item">
                                            <span>üîÆ</span>
                                            <div><strong>VAE</strong> - Graf: z ‚Üí x (latent genereaza observat)</div>
                                        </li>
                                        <li class="reference-item">
                                            <span>üåê</span>
                                            <div><strong>Hidden Markov Model</strong> - z_t ‚Üí z_{t+1}, z_t ‚Üí x_t</div>
                                        </li>
                                        <li class="reference-item">
                                            <span>üìù</span>
                                            <div><strong>Naive Bayes</strong> - Class ‚Üí Features (stelat)</div>
                                        </li>
                                        <li class="reference-item">
                                            <span>ü§ñ</span>
                                            <div><strong>Autoregressive Models</strong> - x_1 ‚Üí x_2 ‚Üí ... ‚Üí x_n</div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="interactive-paragraph">
                    <div class="paragraph-main" onclick="toggleParagraph(this)">
                        <h4>Modele Undirected (Markov Random Fields)</h4>
                        <p>Modelele <strong>undirected</strong> folosesc grafuri fara orientare. Factorizarea este in <strong>functii potential</strong> œà (nu neaparat probabilitati!): p(<strong>x</strong>) = (1/Z) ‚àè_C œà_C(<strong>x</strong>_C), unde C sunt "clicile" grafului. Factorul Z (partition function) normalizeaza, dar e adesea greu de calculat!</p>
                    </div>
                    <div class="expandable-sections">
                        <div class="section-tab">
                            <div class="section-header" onclick="toggleSection(this)">
                                <div class="section-icon reference">üìö</div>
                                <span>Directed vs Undirected</span>
                                <span class="arrow">‚ñ∂</span>
                            </div>
                            <div class="section-content">
                                <div class="section-body">
                                    <div class="key-concept">
                                        <strong>Comparatie:</strong>
                                        <table style="width: 100%; margin-top: 10px; font-size: 0.85rem;">
                                            <tr>
                                                <th style="text-align: left;">Aspect</th>
                                                <th style="text-align: left;">Directed</th>
                                                <th style="text-align: left;">Undirected</th>
                                            </tr>
                                            <tr>
                                                <td>Factori</td>
                                                <td>Prob. conditionate</td>
                                                <td>Potentiale (‚â•0)</td>
                                            </tr>
                                            <tr>
                                                <td>Normalizare</td>
                                                <td>Automata</td>
                                                <td>Necesita Z</td>
                                            </tr>
                                            <tr>
                                                <td>Sampling</td>
                                                <td>Usor (ancestral)</td>
                                                <td>MCMC</td>
                                            </tr>
                                            <tr>
                                                <td>Exemple</td>
                                                <td>VAE, LM</td>
                                                <td>CRF, RBM</td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </section>
