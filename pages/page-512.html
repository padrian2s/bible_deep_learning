<section class="page-section" id="page-512">
    <div class="page-header">
        <div class="page-number">512</div>
        <div class="page-title">
            <h3>Sparse Coding: Antrenare</h3>
            <span>Encoder Non-Parametric</span>
        </div>
    </div>
    <div class="image-container">
        <img src="../book_page_jpg/Ian Goodfellow, Yoshua Bengio, Aaron Courville - Deep Learning (2017, MIT)-page-512.jpg"
             alt="Pagina 512" class="page-image" onclick="zoomImage(this)">
    </div>
    <div class="explanation-content">

        <div class="interactive-paragraph">
            <div class="paragraph-main" onclick="toggleParagraph(this)">
                <h4>Training Sparse Coding</h4>
                <p>Antrenarea cu maximum likelihood e <strong>intractabila</strong>. In schimb, alternezi intre: (1) codificare - gaseste h* pentru fiecare x, (2) decodare - antreneaza W sa reconstruiasca bine x din h*.</p>
            </div>
            <div class="expandable-sections">
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon simulation">ðŸŽ®</div>
                        <span>Problema de Optimizare</span>
                        <span class="arrow">â–¶</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div class="formula">
                                h* = f(x) = argmax<sub>h</sub> p(h|x)<br><br>
                                = argmax<sub>h</sub> log p(h|x)<br><br>
                                = argmin<sub>h</sub> lambda||h||<sub>1</sub> + beta||x - Wh||Â²<sub>2</sub>
                            </div>
                            <p style="color: var(--text-secondary); margin-top: 15px;">Aceasta e problema LASSO! Impune sparsitate pe h prin penalizarea L1.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="interactive-paragraph">
            <div class="paragraph-main" onclick="toggleParagraph(this)">
                <h4>Encoder ca Optimizare</h4>
                <p>Spre deosebire de PCA unde encoder-ul e o simpla inmultire cu matrice, in sparse coding encoder-ul e un <strong>algoritm de optimizare</strong> care rezolva problema de mai sus pentru fiecare input x.</p>
            </div>
            <div class="expandable-sections">
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon animation">âœ¨</div>
                        <span>Avantaje si Dezavantaje</span>
                        <span class="arrow">â–¶</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                <div style="background: var(--bg-lighter); padding: 15px; border-radius: 8px;">
                                    <strong style="color: var(--success);">Avantaje</strong>
                                    <ul style="color: var(--text-secondary); margin-top: 5px; font-size: 0.9em;">
                                        <li>Minimizeaza reconstruction + prior</li>
                                        <li>Nu are eroare de generalizare in encoder</li>
                                        <li>Generalizeaza mai bine cu putine labels</li>
                                    </ul>
                                </div>
                                <div style="background: var(--bg-lighter); padding: 15px; border-radius: 8px;">
                                    <strong style="color: var(--warning);">Dezavantaje</strong>
                                    <ul style="color: var(--text-secondary); margin-top: 5px; font-size: 0.9em;">
                                        <li>Lent - necesita iteratii la test time</li>
                                        <li>Greu de facut backprop prin el</li>
                                        <li>Greu de pretrenat nesupervizat</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="interactive-paragraph">
            <div class="paragraph-main" onclick="toggleParagraph(this)">
                <h4>Alternarea Training</h4>
                <p>Tratam beta ca hyperparameter (de obicei beta=1). Alternezi: minimizare dupa h (pentru fiecare x), apoi minimizare dupa W (pentru tot dataset-ul).</p>
            </div>
            <div class="expandable-sections">
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon reference">ðŸ“š</div>
                        <span>Conexiune cu Autoencoders</span>
                        <span class="arrow">â–¶</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <p style="color: var(--text-secondary);">Sparse autoencoders (Cap. 14) folosesc encoder parametric pentru a aproxima optimizarea - mult mai rapizi, dar pierd garantia de optimalitate.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</section>
