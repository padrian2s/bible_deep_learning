<section class="page-section" id="page-551">
    <div class="page-header">
        <div class="page-number">551</div>
        <div class="page-title">
            <h3>Transfer Learning si Domain Adaptation</h3>
            <span>Capitolul 15 - Sectiunea 15.2</span>
        </div>
    </div>
    <div class="image-container">
        <img src="book_page_jpg/page-551.jpg"
             alt="Pagina 551" class="page-image" onclick="zoomImage(this)">
    </div>
    <div class="explanation-content">
        <div class="interactive-paragraph">
            <div class="paragraph-main" onclick="toggleParagraph(this)">
                <h4>15.2 Transfer Learning si Domain Adaptation</h4>
                <p><strong>Transfer learning</strong> si <strong>domain adaptation</strong> se refera la situatia in care ceea ce a fost invatat intr-un setting (distributia P‚ÇÅ) este exploatat pentru a imbunatati generalizarea in alt setting (distributia P‚ÇÇ). In transfer learning, presupunem ca multi factori care explica variatiile in P‚ÇÅ sunt relevanti si pentru P‚ÇÇ. Exemplu: inveti despre pisici si caini, apoi transferi la furnici si viespi.</p>
            </div>
            <div class="expandable-sections">
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon reference">üìö</div>
                        <span>Transfer Learning in Practica</span>
                        <span class="arrow">‚ñ∂</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div class="key-concept">
                                <h5>Exemplu: ImageNet Pretraining</h5>
                                <p>Retele convolutionale antrenate pe ImageNet (milioane de imagini) sunt folosite ca punct de start pentru task-uri cu putine date:</p>
                                <ul style="margin-left: 20px;">
                                    <li>Detectie obiecte</li>
                                    <li>Segmentare semantica</li>
                                    <li>Imagini medicale</li>
                                    <li>Recunoastere fete</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="interactive-paragraph">
            <div class="paragraph-main" onclick="toggleParagraph(this)">
                <h4>Straturi Partajate vs Task-Specific</h4>
                <p>Multe categorii vizuale <strong>impart notiuni low-level</strong>: margini, forme, efecte geometrice, iluminare. Transfer learning si domain adaptation pot fi realizate cand exista features utile pentru mai multe task-uri. Arhitectura tipica: <strong>straturi inferioare partajate</strong> (features generice) si <strong>straturi superioare task-specific</strong>. Uneori invers: output partajat, input task-specific (ex: speech recognition - foneme diferite per vorbitor, dar aceeasi gramatica).</p>
            </div>
            <div class="expandable-sections">
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon animation">‚ú®</div>
                        <span>Vizualizare: Figura 15.2</span>
                        <span class="arrow">‚ñ∂</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div style="background: var(--bg-dark); padding: 20px; border-radius: 8px;">
                                <p style="text-align: center; margin-bottom: 15px;"><strong>Multi-Task Architecture</strong></p>
                                <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                                    <div style="background: var(--success); padding: 15px 40px; border-radius: 8px;">y (output partajat)</div>
                                    <div style="font-size: 1.5rem;">‚Üë</div>
                                    <div style="background: var(--secondary); padding: 15px 40px; border-radius: 8px;">h<sup>shared</sup></div>
                                    <div style="display: flex; gap: 20px; margin-top: 10px;">
                                        <div style="text-align: center;">
                                            <div style="font-size: 1.2rem;">‚Üë</div>
                                            <div style="background: var(--primary); padding: 10px; border-radius: 8px;">h<sup>(1)</sup></div>
                                            <div style="font-size: 1.2rem;">‚Üë</div>
                                            <div style="background: var(--accent); padding: 10px; border-radius: 8px;">x<sup>(1)</sup></div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-size: 1.2rem;">‚Üë</div>
                                            <div style="background: var(--primary); padding: 10px; border-radius: 8px;">h<sup>(2)</sup></div>
                                            <div style="font-size: 1.2rem;">‚Üë</div>
                                            <div style="background: var(--accent); padding: 10px; border-radius: 8px;">x<sup>(2)</sup></div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-size: 1.2rem;">‚Üë</div>
                                            <div style="background: var(--primary); padding: 10px; border-radius: 8px;">h<sup>(3)</sup></div>
                                            <div style="font-size: 1.2rem;">‚Üë</div>
                                            <div style="background: var(--accent); padding: 10px; border-radius: 8px;">x<sup>(3)</sup></div>
                                        </div>
                                    </div>
                                </div>
                                <p style="text-align: center; margin-top: 15px; font-size: 0.85rem; color: var(--text-secondary);">Input-uri task-specific ‚Üí Reprezentari task-specific ‚Üí Reprezentare partajata ‚Üí Output comun</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon simulation">üéÆ</div>
                        <span>Modern: Transfer cu Hugging Face</span>
                        <span class="arrow">‚ñ∂</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div class="code-block">
# Transfer Learning modern cu PyTorch si Hugging Face

from transformers import AutoModel, AutoTokenizer
import torch.nn as nn

class TransferClassifier(nn.Module):
    """
    Folosim un model pretrained si adaugam un head task-specific
    """
    def __init__(self, pretrained_name, num_classes, freeze_base=True):
        super().__init__()
        # Straturi partajate (pretrained)
        self.base = AutoModel.from_pretrained(pretrained_name)

        # Optinal: inghetam straturile de baza
        if freeze_base:
            for param in self.base.parameters():
                param.requires_grad = False

        # Strat task-specific
        hidden_size = self.base.config.hidden_size
        self.classifier = nn.Linear(hidden_size, num_classes)

    def forward(self, input_ids, attention_mask):
        # Features din modelul pretrained
        outputs = self.base(input_ids, attention_mask)
        pooled = outputs.last_hidden_state[:, 0]  # [CLS] token

        # Clasificare task-specific
        return self.classifier(pooled)

# Utilizare:
# model = TransferClassifier("bert-base-uncased", num_classes=3)
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
