<section class="page-section" id="page-482">
    <div class="page-header">
        <div class="page-number">482</div>
        <div class="page-title">
            <h3>Capitolul 12: Aplicatii</h3>
            <span>12.4.3.2 Hierarchical Softmax</span>
        </div>
    </div>
    <div class="image-container">
        <img src="../book_page_jpg/Ian Goodfellow, Yoshua Bengio, Aaron Courville - Deep Learning (2017, MIT)-page-482.jpg"
             alt="Pagina 482" class="page-image" onclick="zoomImage(this)">
    </div>
    <div class="explanation-content">

        <div class="interactive-paragraph">
            <div class="paragraph-main" onclick="toggleParagraph(this)">
                <h4>12.4.3.2 Hierarchical Softmax</h4>
                <p>O abordare clasica pentru reducerea costului computational al softmax-ului peste vocabulare mari este <strong>descompunerea ierarhica a probabilitatilor</strong>. In loc de O(|V|) calcule, putem reduce la O(log |V|) prin construirea unui arbore de categorii de cuvinte.</p>
            </div>
            <div class="expandable-sections">
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon animation">âœ¨</div>
                        <span>Vizualizare: Arborele de Categorii</span>
                        <span class="arrow">â–¶</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div style="background: var(--bg-lighter); padding: 20px; border-radius: 8px;">
                                <div style="text-align: center; margin-bottom: 20px;">
                                    <div style="display: inline-block; background: var(--accent); padding: 10px 20px; border-radius: 8px; color: var(--bg-dark);">
                                        <strong>Root</strong>
                                    </div>
                                </div>
                                <div style="display: flex; justify-content: center; gap: 40px; margin-bottom: 20px;">
                                    <div style="text-align: center;">
                                        <div style="background: var(--success); padding: 8px 15px; border-radius: 4px; color: var(--bg-dark);">Nouns</div>
                                        <div style="display: flex; gap: 10px; margin-top: 10px; justify-content: center;">
                                            <div style="background: var(--bg-dark); padding: 5px 10px; border-radius: 4px; font-size: 0.8rem;">Animals</div>
                                            <div style="background: var(--bg-dark); padding: 5px 10px; border-radius: 4px; font-size: 0.8rem;">Places</div>
                                        </div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="background: var(--warning); padding: 8px 15px; border-radius: 4px; color: var(--bg-dark);">Verbs</div>
                                        <div style="display: flex; gap: 10px; margin-top: 10px; justify-content: center;">
                                            <div style="background: var(--bg-dark); padding: 5px 10px; border-radius: 4px; font-size: 0.8rem;">Action</div>
                                            <div style="background: var(--bg-dark); padding: 5px 10px; border-radius: 4px; font-size: 0.8rem;">State</div>
                                        </div>
                                    </div>
                                </div>
                                <p style="color: var(--text-secondary); text-align: center; font-size: 0.9rem;">Cuvintele sunt la frunze. Adancimea arborelui: O(log |V|)</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon simulation">ðŸŽ®</div>
                        <span>Simulare: Calculul Probabilitatii</span>
                        <span class="arrow">â–¶</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div class="code-block">
# Hierarchical Softmax
# Probabilitatea unui cuvant = produsul probabilitatilor
# pe calea de la radacina la frunza

class HierarchicalSoftmax(nn.Module):
    def __init__(self, hidden_dim, tree):
        super().__init__()
        self.tree = tree  # Binary tree structure
        # Un clasificator logistic la fiecare nod intern
        self.node_classifiers = nn.ModuleDict({
            node: nn.Linear(hidden_dim, 1)
            for node in tree.internal_nodes
        })

    def probability(self, h, word):
        # h: hidden state
        # word: target word
        path = self.tree.path_to_word(word)
        prob = 1.0

        for node, direction in path:
            # direction: 0=left, 1=right
            logit = self.node_classifiers[node](h)
            p_right = torch.sigmoid(logit)

            if direction == 1:
                prob *= p_right
            else:
                prob *= (1 - p_right)

        return prob  # O(log |V|) operatii!
                            </div>
                        </div>
                    </div>
                </div>
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon reference">ðŸ“š</div>
                        <span>Referinte: Hierarchical Softmax</span>
                        <span class="arrow">â–¶</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <ul class="reference-list">
                                <li class="reference-item"><span>ðŸ“„</span><div><strong>Goodman (2001)</strong> - Ideea originala pentru n-gram models</div></li>
                                <li class="reference-item"><span>ðŸ“„</span><div><strong>Bengio (2002); Morin & Bengio (2005)</strong> - Aplicare pentru neural language models</div></li>
                                <li class="reference-item"><span>ðŸ“„</span><div><strong>Mnih & Hinton (2009)</strong> - Multiple paths pentru cuvinte cu sensuri multiple</div></li>
                            </ul>
                            <div class="key-concept" style="margin-top: 15px;">
                                <strong>Avantaj:</strong> Log-likelihood-ul poate fi calculat eficient - O(log |V|) in loc de O(|V|). Aceasta include si gradientii!
                            </div>
                            <p style="margin-top: 10px; color: var(--text-secondary);">Se poate optimiza structura arborelui folosind teoria informatiei pentru a alege codul binar optim bazat pe frecventele cuvintelor.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</section>
