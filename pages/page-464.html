<section class="page-section" id="page-464">
    <div class="page-header">
        <div class="page-number">464</div>
        <div class="page-title">
            <h3>Capitolul 12: Aplicatii</h3>
            <span>12.1.5 Structura Dinamica: Cascade si Decision Trees</span>
        </div>
    </div>
    <div class="image-container">
        <img src="../book_page_jpg/Ian Goodfellow, Yoshua Bengio, Aaron Courville - Deep Learning (2017, MIT)-page-464.jpg"
             alt="Pagina 464" class="page-image" onclick="zoomImage(this)">
    </div>
    <div class="explanation-content">

        <div class="interactive-paragraph">
            <div class="paragraph-main" onclick="toggleParagraph(this)">
                <h4>Cascade de Clasificatori</h4>
                <p>O strategie venerabila pentru accelerarea inferentei este folosirea unei <strong>cascade de clasificatori</strong>. Aceasta este utila cand vrem sa detectam prezenta unui obiect rar. Primul clasificator (low capacity, high recall) respinge rapid exemplele fara obiect, iar doar cele ramase ajung la clasificatorul complex.</p>
            </div>
            <div class="expandable-sections">
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon animation">‚ú®</div>
                        <span>Vizualizare: Cascada de Clasificatori</span>
                        <span class="arrow">‚ñ∂</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div style="background: var(--bg-lighter); padding: 20px; border-radius: 8px;">
                                <div style="display: flex; flex-direction: column; gap: 15px;">
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <div style="background: var(--success); padding: 15px 20px; border-radius: 8px; color: var(--bg-dark);">
                                            <strong>Stage 1</strong><br>
                                            <span style="font-size: 0.8rem;">Fast, High Recall</span>
                                        </div>
                                        <div style="flex: 1; display: flex; align-items: center; gap: 10px;">
                                            <span style="color: var(--text-secondary);">‚Üí</span>
                                            <div style="background: var(--warning); padding: 5px 15px; border-radius: 4px; color: var(--bg-dark);">90% REJECT</div>
                                            <span style="color: var(--text-secondary);">‚Üì 10%</span>
                                        </div>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 10px; margin-left: 40px;">
                                        <div style="background: var(--accent); padding: 15px 20px; border-radius: 8px; color: var(--bg-dark);">
                                            <strong>Stage 2</strong><br>
                                            <span style="font-size: 0.8rem;">Medium complexity</span>
                                        </div>
                                        <div style="flex: 1; display: flex; align-items: center; gap: 10px;">
                                            <span style="color: var(--text-secondary);">‚Üí</span>
                                            <div style="background: var(--warning); padding: 5px 15px; border-radius: 4px; color: var(--bg-dark);">70% REJECT</div>
                                            <span style="color: var(--text-secondary);">‚Üì 3%</span>
                                        </div>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 10px; margin-left: 80px;">
                                        <div style="background: var(--primary); padding: 15px 20px; border-radius: 8px; color: white;">
                                            <strong>Stage 3</strong><br>
                                            <span style="font-size: 0.8rem;">High Precision</span>
                                        </div>
                                        <div style="flex: 1; display: flex; align-items: center; gap: 10px;">
                                            <span style="color: var(--text-secondary);">‚Üí</span>
                                            <div style="background: var(--success); padding: 5px 15px; border-radius: 4px; color: var(--bg-dark);">FINAL DECISION</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <p style="margin-top: 15px; color: var(--text-secondary);">Verificam prezenta obiectelor cu incredere mare fara costul complet al inferentei pentru fiecare exemplu!</p>
                        </div>
                    </div>
                </div>
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon reference">üìö</div>
                        <span>Referinte: Cascade Classifiers</span>
                        <span class="arrow">‚ñ∂</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <ul class="reference-list">
                                <li class="reference-item"><span>üìÑ</span><div><strong>Viola & Jones (2001)</strong> - Cascade de boosted decision trees pentru detectia fetelor in camere digitale</div></li>
                                <li class="reference-item"><span>üìÑ</span><div><strong>Goodfellow et al. (2014d)</strong> - Google Street View: cascade cu doua etape pentru transcrierea numerelor de adrese</div></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="interactive-paragraph">
            <div class="paragraph-main" onclick="toggleParagraph(this)">
                <h4>Decision Trees si Hard Attention</h4>
                <p><strong>Decision trees</strong> sunt un exemplu de structura dinamica - fiecare nod determina ce sub-arbore trebuie evaluat. O alta varianta de cascade foloseste primele modele pentru a <strong>localiza</strong> obiectul (hard attention), iar cele ulterioare pentru procesare detaliata.</p>
            </div>
            <div class="expandable-sections">
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon simulation">üéÆ</div>
                        <span>Simulare: Neural Decision Tree</span>
                        <span class="arrow">‚ñ∂</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div class="code-block">
# Neural Decision Tree (Guo & Gelfand, 1992)
# Fiecare nod foloseste o retea neurala pentru decizia de split

class NeuralDecisionTree:
    def __init__(self, depth):
        self.nodes = [NeuralSplitter() for _ in range(2**depth - 1)]
        self.leaves = [Classifier() for _ in range(2**depth)]

    def forward(self, x):
        node_idx = 0
        for level in range(self.depth):
            # Reteaua decide: stanga sau dreapta?
            decision = self.nodes[node_idx](x)  # sigmoid output
            if decision > 0.5:
                node_idx = 2 * node_idx + 2  # dreapta
            else:
                node_idx = 2 * node_idx + 1  # stanga

        return self.leaves[node_idx](x)
                            </div>
                            <p style="margin-top: 15px; color: var(--text-secondary);">Combinam puterea reprezentationala a retelelor neurale cu eficienta computationala a arborilor de decizie!</p>
                        </div>
                    </div>
                </div>
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon animation">‚ú®</div>
                        <span>Vizualizare: Two-Step Cascade</span>
                        <span class="arrow">‚ñ∂</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; align-items: center;">
                                <div style="background: var(--bg-lighter); padding: 20px; border-radius: 8px; text-align: center;">
                                    <div style="font-size: 2rem;">üñºÔ∏è</div>
                                    <strong style="color: var(--accent);">Step 1: Localizare</strong>
                                    <p style="color: var(--text-secondary); font-size: 0.8rem; margin-top: 10px;">Gaseste unde e numarul de adresa</p>
                                </div>
                                <div style="color: var(--accent); font-size: 2rem;">‚Üí</div>
                                <div style="background: var(--bg-lighter); padding: 20px; border-radius: 8px; text-align: center;">
                                    <div style="font-size: 2rem;">üî¢</div>
                                    <strong style="color: var(--success);">Step 2: Transcriere</strong>
                                    <p style="color: var(--text-secondary); font-size: 0.8rem; margin-top: 10px;">Citeste cifrele din zona gasita</p>
                                </div>
                            </div>
                            <div class="key-concept" style="margin-top: 15px;">
                                <strong>Google Street View:</strong> Primul model localizeaza numarul de adresa, al doilea il transcrie. Aceasta abordare este mai eficienta decat procesarea intregii imagini.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</section>
