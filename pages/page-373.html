<section class="page-section" id="page-373">
    <div class="page-header">
        <div class="page-number">373</div>
        <div class="page-title">
            <h3>9.6 Structured Outputs</h3>
            <span>Bias Terms si Output-uri Structurate</span>
        </div>
    </div>
    <div class="image-container">
        <img src="book_page_jpg/page-373.jpg"
             alt="Pagina 373" class="page-image" onclick="zoomImage(this)">
    </div>
    <div class="explanation-content">

        <div class="interactive-paragraph">
            <div class="paragraph-main" onclick="toggleParagraph(this)">
                <h4>Bias-ul in Layerele Convolutionale</h4>
                <p>Layerele convolutionale au si un termen de <strong>bias</strong>, adaugat dupa convolutie. De obicei, avem un singur bias per canal de output, partajat peste toate pozitiile spatiale (la fel ca kernelul). Pentru locally connected, putem avea bias-uri diferite per pozitie. Bias-ul permite ajustarea pentru diferente statistice intre regiuni.</p>
            </div>
            <div class="expandable-sections">
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon simulation">üéÆ</div>
                        <span>Simulare: Bias in Conv2d</span>
                        <span class="arrow">‚ñ∂</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div class="code-block">
import torch
import torch.nn as nn

# Conv2d cu bias (default)
conv_with_bias = nn.Conv2d(3, 64, kernel_size=3, padding=1)
print("Kernel shape:", conv_with_bias.weight.shape)  # [64, 3, 3, 3]
print("Bias shape:", conv_with_bias.bias.shape)      # [64]

# Fiecare din cele 64 canale are UN singur bias
# Bias-ul se adauga uniform la toate pozitiile spatiale

# Conv2d fara bias (recomandat cand urmeaza BatchNorm)
conv_no_bias = nn.Conv2d(3, 64, kernel_size=3, padding=1, bias=False)
# BatchNorm are propriul bias, deci e redundant

# Regula practica:
# Conv -> ReLU: bias=True
# Conv -> BatchNorm -> ReLU: bias=False
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="interactive-paragraph">
            <div class="paragraph-main" onclick="toggleParagraph(this)">
                <h4>Output-uri Structurate: Mai mult decat Clasificare</h4>
                <p>CNN-urile pot produce output-uri mai complexe decat o singura eticheta de clasa. Pentru <strong>segmentare semantica</strong>, outputul este un tensor S unde S[i,j,k] reprezinta probabilitatea ca pixelul (j,k) sa apartina clasei i. Practic, clasificam FIECARE pixel din imagine! Aceasta necesita output-uri de aceeasi dimensiune ca inputul.</p>
            </div>
            <div class="expandable-sections">
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon animation">‚ú®</div>
                        <span>Vizualizare: Clasificare vs Segmentare</span>
                        <span class="arrow">‚ñ∂</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <div style="background: var(--bg-lighter); padding: 15px; border-radius: 8px; text-align: center;">
                                    <strong style="color: var(--primary);">Clasificare</strong>
                                    <div style="margin: 15px 0;">
                                        <div style="background: var(--bg-dark); width: 80px; height: 80px; margin: 0 auto; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                            <span style="font-size: 2rem;">üê±</span>
                                        </div>
                                        <div style="margin-top: 10px;">‚Üì CNN ‚Üì</div>
                                        <div style="background: var(--success); padding: 10px; border-radius: 4px; margin-top: 10px;">
                                            "cat" (0.95)
                                        </div>
                                    </div>
                                    <small>Un label per imagine</small>
                                </div>
                                <div style="background: var(--bg-lighter); padding: 15px; border-radius: 8px; text-align: center;">
                                    <strong style="color: var(--accent);">Segmentare</strong>
                                    <div style="margin: 15px 0;">
                                        <div style="background: var(--bg-dark); width: 80px; height: 80px; margin: 0 auto; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                            <span style="font-size: 2rem;">üê±</span>
                                        </div>
                                        <div style="margin-top: 10px;">‚Üì FCN ‚Üì</div>
                                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 2px; margin-top: 10px;">
                                            <div style="background: var(--success); padding: 5px; border-radius: 2px;"></div>
                                            <div style="background: var(--success); padding: 5px; border-radius: 2px;"></div>
                                            <div style="background: var(--bg-dark); padding: 5px; border-radius: 2px;"></div>
                                            <div style="background: var(--bg-dark); padding: 5px; border-radius: 2px;"></div>
                                            <div style="background: var(--success); padding: 5px; border-radius: 2px;"></div>
                                            <div style="background: var(--success); padding: 5px; border-radius: 2px;"></div>
                                            <div style="background: var(--success); padding: 5px; border-radius: 2px;"></div>
                                            <div style="background: var(--bg-dark); padding: 5px; border-radius: 2px;"></div>
                                        </div>
                                    </div>
                                    <small>Un label per pixel</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="section-tab">
                    <div class="section-header" onclick="toggleSection(this)">
                        <div class="section-icon reference">üìö</div>
                        <span>Aplicatii Structured Output</span>
                        <span class="arrow">‚ñ∂</span>
                    </div>
                    <div class="section-content">
                        <div class="section-body">
                            <div style="display: grid; gap: 10px;">
                                <div style="background: var(--bg-lighter); padding: 12px; border-radius: 8px;">
                                    <strong style="color: var(--success);">Segmentare Semantica</strong>
                                    <p style="font-size: 0.85rem; margin-top: 5px;">Output: HxWxC (C clase per pixel)</p>
                                </div>
                                <div style="background: var(--bg-lighter); padding: 12px; border-radius: 8px;">
                                    <strong style="color: var(--accent);">Depth Estimation</strong>
                                    <p style="font-size: 0.85rem; margin-top: 5px;">Output: HxW (adancime per pixel)</p>
                                </div>
                                <div style="background: var(--bg-lighter); padding: 12px; border-radius: 8px;">
                                    <strong style="color: var(--primary);">Super-Resolution</strong>
                                    <p style="font-size: 0.85rem; margin-top: 5px;">Output: (H√ó4)x(W√ó4)x3 (imagine marita)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</section>
